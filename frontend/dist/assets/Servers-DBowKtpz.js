import{r as d,j as e,L as je}from"./main-DlP4xrLE.js";import{A as ee}from"./AdminBar-CopzlQoJ.js";import{P as ve,a as Ne,T as ke}from"./trash-Dxn7BH0w.js";import{C as Ie}from"./chevron-right-BFVVCxDN.js";import{A as z}from"./arrow-left-DQ1b-r7_.js";const Me=()=>{const[U,se]=d.useState([]),[P,te]=d.useState([]),[v,ae]=d.useState([]),[O,re]=d.useState([]),[T,V]=d.useState([]),[ne,_]=d.useState(!0),[J,A]=d.useState(null),[p,x]=d.useState("list"),[r,N]=d.useState(null),[H,f]=d.useState([]),[W,I]=d.useState(!1),[Y,k]=d.useState([]),[G,S]=d.useState(!1),[h,F]=d.useState("nodes"),[ie,K]=d.useState(!1),[l,R]=d.useState({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100}),[i,y]=d.useState({name:"",unitId:"",memoryMiB:0,diskMiB:0,cpuPercent:0}),[B,b]=d.useState(null),[L,de]=d.useState(""),[w,Q]=d.useState(""),[oe,le]=d.useState([]),[X,ce]=d.useState([]),[q,$]=d.useState(!1);d.useEffect(()=>{l.unitId?xe(l.unitId):(f([]),I(!1))},[l.unitId]),d.useEffect(()=>{p==="edit"&&i.unitId&&me(i.unitId)},[p,i.unitId]),d.useEffect(()=>{D()},[]),d.useEffect(()=>{p==="create"&&ue()},[p]),d.useEffect(()=>{const t=O.filter(a=>a.username.toLowerCase().includes(L.toLowerCase()));le(t)},[L,O]),d.useEffect(()=>{const t=v.filter(a=>a.name.toLowerCase().includes(w.toLowerCase())||a.shortName.toLowerCase().includes(w.toLowerCase()));ce(t)},[w,v]);const me=async t=>{try{const a=localStorage.getItem("token"),o=await fetch(`/api/units/${t}/docker-images`,{headers:{Authorization:`Bearer ${a}`}});if(o.ok){const n=await o.json();if(n.dockerImages&&Array.isArray(n.dockerImages)&&n.dockerImages.length>0)k(n.dockerImages),S(!0);else{const s=v.find(c=>c.id===t);k(s?[{image:s.dockerImage,displayName:"Default Image"}]:[]),S(!1)}}else{const n=v.find(s=>s.id===t);k(n?[{image:n.dockerImage,displayName:"Default Image"}]:[]),S(!1)}}catch(a){console.error("Failed to fetch unit Docker images:",a),k([]),S(!1)}},xe=async t=>{try{const a=localStorage.getItem("token"),o=await fetch(`/api/units/${t}/docker-images`,{headers:{Authorization:`Bearer ${a}`}});if(o.ok){const n=await o.json();if(n.dockerImages&&Array.isArray(n.dockerImages)&&n.dockerImages.length>0)f(n.dockerImages),I(!0),n.defaultDockerImage?m({dockerImage:n.defaultDockerImage}):m({dockerImage:n.dockerImages[0].image});else{const s=v.find(c=>c.id===t);s?(f([{image:s.dockerImage,displayName:"Default Image"}]),m({dockerImage:s.dockerImage})):f([]),I(!1)}}else{const n=v.find(s=>s.id===t);n?(f([{image:n.dockerImage,displayName:"Default Image"}]),m({dockerImage:n.dockerImage})):f([]),I(!1)}}catch(a){console.error("Failed to fetch unit Docker images:",a),f([]),I(!1)}},ue=async()=>{K(!0);try{const t=localStorage.getItem("token"),a=await fetch("/api/regions",{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error("Failed to fetch regions");const o=await a.json();V(o)}catch(t){console.error("Failed to fetch regions:",t),F("nodes")}finally{K(!1)}},D=async()=>{try{_(!0);const a={Authorization:`Bearer ${localStorage.getItem("token")}`},[o,n,s,c,u]=await Promise.all([fetch("/api/servers?include[node]=true&include[unit]=true&include[user]=true",{headers:a}),fetch("/api/nodes",{headers:a}),fetch("/api/units",{headers:a}),fetch("/api/users",{headers:a}),fetch("/api/regions",{headers:a})]);if(!o.ok)throw new Error("Failed to fetch servers");if(!n.ok)throw new Error("Failed to fetch nodes");if(!s.ok)throw new Error("Failed to fetch units");if(!c.ok)throw new Error("Failed to fetch users");const[g,j,M,E]=await Promise.all([o.json(),n.json(),s.json(),c.json()]);let C=[];u.ok&&(C=await u.json(),V(C)),se(g),te(j),ae(M),re(E),A(null)}catch(t){A(t instanceof Error?t.message:"An error occurred")}finally{_(!1)}},ge=async t=>{t.preventDefault(),b(null);try{const a={...l};!!a.regionId&&(delete a.nodeId,delete a.allocationId),a.startupCommand||delete a.startupCommand;const n=localStorage.getItem("token"),s=await fetch("/api/servers",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){const c=await s.json();throw new Error(c.error||"Failed to create server")}await D(),x("list"),R({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100,regionId:"",dockerImage:"",startupCommand:""})}catch(a){b(a instanceof Error?a.message:"Failed to create server")}},he=async t=>{var a,o;if(t.preventDefault(),!!r){b(null),$(!0);try{const n={};if(i.name!==r.name&&(n.name=i.name),i.unitId!==r.unitId&&(n.unitId=i.unitId),i.memoryMiB!==r.memoryMiB&&(n.memoryMiB=i.memoryMiB),i.diskMiB!==r.diskMiB&&(n.diskMiB=i.diskMiB),i.cpuPercent!==r.cpuPercent&&(n.cpuPercent=i.cpuPercent),i.dockerImage!==((a=r.status)==null?void 0:a.image)&&(n.dockerImage=i.dockerImage),i.startupCommand!==((o=r.status)==null?void 0:o.startup_command)&&(n.startupCommand=i.startupCommand),Object.keys(n).length===0){x("view"),$(!1);return}const s=localStorage.getItem("token"),c=await fetch(`/api/servers/${r.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(n)});if(!c.ok){const g=await c.json();throw new Error(g.error||"Failed to update server")}await D();const u=U.find(g=>g.id===r.id);u&&N(u),x("view")}catch(n){b(n instanceof Error?n.message:"Failed to update server")}finally{$(!1)}}},pe=async t=>{try{const a=localStorage.getItem("token"),o=await fetch(`/api/servers/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!o.ok){const n=await o.json();throw new Error(n.error||"Failed to delete server")}await D(),(r==null?void 0:r.id)===t&&(x("list"),N(null))}catch(a){A(a instanceof Error?a.message:"Failed to delete server")}},m=t=>{R(a=>({...a,...t}))},ye=()=>{var t,a,o,n;return e.jsxs("form",{onSubmit:ge,className:"space-y-4 max-w-lg",children:[B&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-red-600",children:B})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:l.name,onChange:s=>m({name:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"my-server",required:!0})]}),e.jsx("div",{className:"border-b border-gray-200 mb-2",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{type:"button",onClick:()=>F("nodes"),className:`pb-2 text-xs font-medium relative ${h==="nodes"?"text-gray-800 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:["Specific Node",h==="nodes"&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-indigo-600"})]}),e.jsxs("button",{type:"button",onClick:()=>F("regions"),className:`pb-2 ml-6 text-xs font-medium relative ${h==="regions"?"text-gray-800 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:["Region (Load Balanced)",h==="regions"&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-indigo-600"})]})]})}),h==="nodes"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Node"}),e.jsxs("select",{value:l.nodeId||"",onChange:s=>m({nodeId:s.target.value,regionId:"",allocationId:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:h==="nodes",children:[e.jsx("option",{value:"",children:"Select a node"}),P.map(s=>e.jsxs("option",{value:s.id,disabled:!s.isOnline,children:[s.name," (",s.fqdn,") ",!s.isOnline&&"- Offline"]},s.id))]})]}),l.nodeId&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Port Allocation"}),e.jsxs("select",{value:l.allocationId||"",onChange:s=>m({allocationId:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:h==="nodes",children:[e.jsx("option",{value:"",children:"Select a port allocation"}),(a=(t=P.find(s=>s.id===l.nodeId))==null?void 0:t.allocations)==null?void 0:a.filter(s=>!s.assigned).map(s=>e.jsxs("option",{value:s.id,children:[s.bindAddress,":",s.port,s.alias&&` (${s.alias})`]},s.id))]}),((n=(o=P.find(s=>s.id===l.nodeId))==null?void 0:o.allocations)==null?void 0:n.filter(s=>!s.assigned).length)===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No available allocations on this node. Please select a different node or create allocations."})]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Region"}),ie?e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-gray-500 rounded-full border-t-transparent"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Loading regions..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:l.regionId||"",onChange:s=>m({regionId:s.target.value,nodeId:"",allocationId:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:h==="regions",children:[e.jsx("option",{value:"",children:"Select a region"}),T.map(s=>{var c,u,g,j;return e.jsxs("option",{value:s.id,disabled:((c=s.stats)==null?void 0:c.onlineNodeCount)===0||((u=s.stats)==null?void 0:u.atCapacity),children:[s.name,((g=s.stats)==null?void 0:g.onlineNodeCount)===0?" (No online nodes)":"",(j=s.stats)!=null&&j.atCapacity?" (At capacity)":""]},s.id)})]}),T.length===0&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No regions configured. Please create a region first or select a specific node."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Argon will automatically select the best node in this region"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Unit"}),e.jsx("input",{type:"text",value:w,onChange:s=>Q(s.target.value),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400 mb-2",placeholder:"Search units..."}),e.jsxs("select",{value:l.unitId,onChange:s=>m({unitId:s.target.value,dockerImage:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:[e.jsx("option",{value:"",children:"Select a unit"}),X.map(s=>{var c;return e.jsxs("option",{value:s.id,children:[s.name," (",s.shortName,") ",((c=s.meta)==null?void 0:c.version)==="argon/unit:v3"?"(v3)":""]},s.id)})]})]}),l.unitId&&H.length>1&&W&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Docker Image"}),e.jsxs("select",{value:l.dockerImage,onChange:s=>m({dockerImage:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:[e.jsx("option",{value:"",children:"Select a Docker image"}),H.map((s,c)=>e.jsxs("option",{value:s.image,children:[s.displayName," (",s.image,")"]},c))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a Docker image for this server. Each image may offer different versions or features."})]}),l.unitId&&W&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Startup Command (Optional)"}),e.jsx("input",{type:"text",value:l.startupCommand||"",onChange:s=>m({startupCommand:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"Leave blank to use unit default"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Customize the startup command or leave blank to use the unit's default."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"User"}),e.jsx("input",{type:"text",value:L,onChange:s=>de(s.target.value),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400 mb-2",placeholder:"Search users..."}),e.jsxs("select",{value:l.userId,onChange:s=>m({userId:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:[e.jsx("option",{value:"",children:"Select a user"}),oe.map(s=>e.jsx("option",{value:s.id,children:s.username},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Memory (MiB)"}),e.jsx("input",{type:"number",value:l.memoryMiB,onChange:s=>m({memoryMiB:parseInt(s.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:128,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Disk (MiB)"}),e.jsx("input",{type:"number",value:l.diskMiB,onChange:s=>m({diskMiB:parseInt(s.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:1024,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"CPU (%)"}),e.jsx("input",{type:"number",value:l.cpuPercent,onChange:s=>m({cpuPercent:parseInt(s.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:25,max:400,required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"submit",className:"px-3 py-2 text-xs font-medium text-white bg-gray-900 rounded-md hover:bg-gray-800",disabled:h==="nodes"&&(!l.nodeId||!l.allocationId)||h==="regions"&&!l.regionId,children:"Create Server"}),e.jsx("button",{type:"button",onClick:()=>{x("list"),N(null),R({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100,regionId:""})},className:"px-3 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:"Cancel"})]})]})},fe=()=>r?e.jsxs("form",{onSubmit:he,className:"space-y-4 max-w-lg",children:[B&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-red-600",children:B})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:i.name,onChange:t=>y({...i,name:t.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"my-server",required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Unit"}),e.jsx("input",{type:"text",value:w,onChange:t=>Q(t.target.value),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400 mb-2",placeholder:"Search units..."}),e.jsx("select",{value:i.unitId,onChange:t=>y({...i,unitId:t.target.value,dockerImage:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:X.map(t=>{var a;return e.jsxs("option",{value:t.id,children:[t.name," (",t.shortName,") ",((a=t.meta)==null?void 0:a.version)==="argon/unit:v3"?"(v3)":""]},t.id)})}),i.unitId!==r.unitId&&e.jsx("p",{className:"mt-2 text-yellow-600 text-xs",children:"Warning: Changing the unit will reinstall the server with the new image. Your server data will be preserved, but the environment will change."})]}),G&&Y.length>1&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Docker Image"}),e.jsxs("select",{value:i.dockerImage||"",onChange:t=>y({...i,dockerImage:t.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",children:[e.jsx("option",{value:"",children:"Use unit default"}),Y.map((t,a)=>e.jsxs("option",{value:t.image,children:[t.displayName," (",t.image,")"]},a))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a specific Docker image or use the unit's default."})]}),G&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Startup Command"}),e.jsx("input",{type:"text",value:i.startupCommand||"",onChange:t=>y({...i,startupCommand:t.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"Leave blank to use unit default"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Customize the startup command or leave blank to use the unit's default."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Memory (MiB)"}),e.jsx("input",{type:"number",value:i.memoryMiB,onChange:t=>y({...i,memoryMiB:parseInt(t.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:128,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Disk (MiB)"}),e.jsx("input",{type:"number",value:i.diskMiB,onChange:t=>y({...i,diskMiB:parseInt(t.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:1024,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"CPU (%)"}),e.jsx("input",{type:"number",value:i.cpuPercent,onChange:t=>y({...i,cpuPercent:parseInt(t.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:25,max:400,required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"submit",disabled:q,className:"px-3 py-2 text-xs font-medium text-white bg-gray-900 rounded-md hover:bg-gray-800 disabled:bg-gray-400",children:q?"Updating...":"Update Server"}),e.jsx("button",{type:"button",disabled:q,onClick:()=>{x("view"),b(null)},className:"px-3 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"})]})]}):null,be=()=>{var a,o,n,s,c,u,g,j,M,E;if(!r)return null;const t=(a=r.node)==null?void 0:a.region;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{x("list"),N(null)},className:"flex items-center text-gray-600 hover:bg-gray-100 p-2 cursor-pointer rounded-md transition hover:text-gray-900",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-500",children:r.internalId})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>{var C,Z;y({name:r.name,unitId:r.unitId,memoryMiB:r.memoryMiB,diskMiB:r.diskMiB,cpuPercent:r.cpuPercent,dockerImage:((C=r.status)==null?void 0:C.image)||"",startupCommand:((Z=r.status)==null?void 0:Z.startup_command)||""}),b(null),x("edit")},className:"flex items-center px-3 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[e.jsx(Ne,{className:"w-3.5 h-3.5 mr-1.5"}),"Edit"]}),e.jsxs("button",{onClick:()=>pe(r.id),className:"flex items-center px-3 py-2 text-xs font-medium text-red-600 bg-white border border-gray-200 rounded-md hover:bg-red-50",children:[e.jsx(ke,{className:"w-3.5 h-3.5 mr-1.5"}),"Delete"]})]})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-md shadow-xs",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Server ID"}),e.jsx("div",{className:"text-sm font-mono mt-1",children:r.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Name"}),e.jsx("div",{className:"text-sm mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Internal ID"}),e.jsx("div",{className:"text-sm mt-1",children:r.internalId})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Current State"}),e.jsx("div",{className:"text-sm mt-1",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.state==="running"?"bg-green-100 text-green-800":r.state==="updating"?"bg-yellow-100 text-yellow-800":r.state==="stopping"?"bg-orange-100 text-orange-800":r.state==="starting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:r.state})})]}),((o=r.status)==null?void 0:o.image)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Docker Image"}),e.jsx("div",{className:"text-sm font-mono mt-1",children:(n=r.status)==null?void 0:n.image})]}),((s=r.status)==null?void 0:s.startup_command)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Startup Command"}),e.jsx("div",{className:"text-sm font-mono mt-1",children:(c=r.status)==null?void 0:c.startup_command})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 mb-3",children:"Resources"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Memory"}),e.jsxs("div",{className:"text-sm mt-1",children:[r.memoryMiB," MiB"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Disk"}),e.jsxs("div",{className:"text-sm mt-1",children:[r.diskMiB," MiB"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"CPU"}),e.jsxs("div",{className:"text-sm mt-1",children:[r.cpuPercent,"%"]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 mb-3",children:"Relationships"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Node"}),e.jsxs("div",{className:"text-sm mt-1",children:[(u=r.node)==null?void 0:u.name," (",(g=r.node)==null?void 0:g.fqdn,")"]})]}),t&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Region"}),e.jsxs("div",{className:"text-sm mt-1",children:[t.name," (",t.identifier,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Unit"}),e.jsxs("div",{className:"text-sm mt-1",children:[(j=r.unit)==null?void 0:j.name," (",(M=r.unit)==null?void 0:M.shortName,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"User"}),e.jsx("div",{className:"text-sm mt-1",children:(E=r.user)==null?void 0:E.username})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Created At"}),e.jsx("div",{className:"text-sm mt-1",children:new Date(r.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Updated At"}),e.jsx("div",{className:"text-sm mt-1",children:new Date(r.updatedAt).toLocaleString()})]})]})})})]})};return ne?e.jsx(je,{}):J?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ee,{}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-red-600 text-xs",children:["Error: ",J]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ee,{}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"transition-all duration-200 ease-in-out",children:[p==="list"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Servers"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage all servers running on your nodes."})]}),e.jsxs("button",{onClick:()=>x("create"),className:"flex items-center px-3 py-2 text-xs font-medium text-white bg-gray-900 rounded-md hover:bg-gray-800",children:[e.jsx(ve,{className:"w-3.5 h-3.5 mr-1.5"}),"Create Server"]})]}),e.jsxs("div",{className:"space-y-2",children:[U.map(t=>{var a,o,n;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-md shadow-xs cursor-pointer hover:border-gray-300",onClick:()=>{N(t),x("view")},children:e.jsxs("div",{className:"px-6 h-20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-2 w-2 rounded-full ${t.state==="running"?"bg-green-400":t.state==="updating"?"bg-yellow-400":t.state==="starting"?"bg-blue-400":"bg-gray-300"}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(a=t.user)==null?void 0:a.username," • ",(o=t.unit)==null?void 0:o.shortName,((n=t.node)==null?void 0:n.region)&&` • ${t.node.region.name}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.cpuPercent,"%"]})," CPU"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.memoryMiB," MiB"]})," RAM"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.diskMiB," MiB"]})," Disk"]})]}),e.jsx(Ie,{className:"w-4 h-4 text-gray-400"})]})]})},t.id)}),U.length===0&&e.jsx("div",{className:"text-center py-6 bg-white rounded-md border border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-500",children:"No servers found"})})]})]}),p==="create"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{x("list"),N(null)},className:"flex items-center text-gray-600 hover:bg-gray-100 p-2 cursor-pointer rounded-md transition hover:text-gray-900",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Create Server"})})]}),ye()]}),p==="edit"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{x("view"),b(null)},className:"flex items-center text-gray-600 hover:bg-gray-100 p-2 cursor-pointer rounded-md transition hover:text-gray-900",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-lg font-semibold text-gray-900",children:["Edit Server: ",r==null?void 0:r.name]})})]}),fe()]}),p==="view"&&be()]})})]})};export{Me as default};
