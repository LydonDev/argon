import{r,c as Y,u as _,j as e,L as q,a as G,C as U}from"./main-DlP4xrLE.js";import{T as z}from"./triangle-alert-rB2LLQsG.js";import{C as J}from"./chevron-right-BFVVCxDN.js";import{F as K}from"./folder-CzYiNY45.js";import{X as Q}from"./x-Chb2dA6l.js";function ee({title:s,titleId:o,...c},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":o},c),s?r.createElement("title",{id:o},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const F=r.forwardRef(ee);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],se=Y("Ellipsis",te);function re({title:s,titleId:o,...c},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":o},c),s?r.createElement("title",{id:o},s):null,r.createElement("path",{fillRule:"evenodd",d:"M11.622 1.602a.75.75 0 0 1 .756 0l2.25 1.313a.75.75 0 0 1-.756 1.295L12 3.118 10.128 4.21a.75.75 0 1 1-.756-1.295l2.25-1.313ZM5.898 5.81a.75.75 0 0 1-.27 1.025l-1.14.665 1.14.665a.75.75 0 1 1-.756 1.295L3.75 8.806v.944a.75.75 0 0 1-1.5 0V7.5a.75.75 0 0 1 .372-.648l2.25-1.312a.75.75 0 0 1 1.026.27Zm12.204 0a.75.75 0 0 1 1.026-.27l2.25 1.312a.75.75 0 0 1 .372.648v2.25a.75.75 0 0 1-1.5 0v-.944l-1.122.654a.75.75 0 1 1-.756-1.295l1.14-.665-1.14-.665a.75.75 0 0 1-.27-1.025Zm-9 5.25a.75.75 0 0 1 1.026-.27L12 11.882l1.872-1.092a.75.75 0 1 1 .756 1.295l-1.878 1.096V15a.75.75 0 0 1-1.5 0v-1.82l-1.878-1.095a.75.75 0 0 1-.27-1.025ZM3 13.5a.75.75 0 0 1 .75.75v1.82l1.878 1.095a.75.75 0 1 1-.756 1.295l-2.25-1.312a.75.75 0 0 1-.372-.648v-2.25A.75.75 0 0 1 3 13.5Zm18 0a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-.372.648l-2.25 1.312a.75.75 0 1 1-.756-1.295l1.878-1.096V14.25a.75.75 0 0 1 .75-.75Zm-9 5.25a.75.75 0 0 1 .75.75v.944l1.122-.654a.75.75 0 1 1 .756 1.295l-2.25 1.313a.75.75 0 0 1-.756 0l-2.25-1.313a.75.75 0 1 1 .756-1.295l1.122.654V19.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const ne=r.forwardRef(re),ae=({children:s,content:o,position:c="right"})=>{const[i,l]=r.useState(!1),m={top:"fixed transform -translate-x-1/2 -translate-y-full mt-[-8px]",right:"fixed transform translate-x-2 -translate-y-1/2",bottom:"fixed transform -translate-x-1/2 translate-y-2",left:"fixed transform -translate-x-full -translate-y-1/2 ml-[-8px]"},v=r.useRef(null),b=r.useRef(null);return r.useEffect(()=>{if(i&&b.current&&v.current){const d=b.current.getBoundingClientRect();let x,u;switch(c){case"top":u=d.left+d.width/2,x=d.top;break;case"right":u=d.right,x=d.top+d.height/2;break;case"bottom":u=d.left+d.width/2,x=d.bottom;break;case"left":u=d.left,x=d.top+d.height/2;break;default:u=d.right,x=d.top+d.height/2}v.current.style.left=`${u}px`,v.current.style.top=`${x}px`}},[i,c]),e.jsxs("div",{className:"relative inline-block",ref:b,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[s,i&&e.jsx("div",{ref:v,className:`${m[c]} z-[999]`,children:e.jsx("div",{className:"px-2.5 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-md shadow-md border border-gray-100 whitespace-nowrap",children:o})})]})},I=({type:s,message:o,onDismiss:c})=>{const i=s==="error"?"bg-red-50":s==="success"?"bg-green-50":"bg-yellow-50",l=s==="error"?"text-red-600":s==="success"?"text-green-600":"text-yellow-600",m=s==="error"?"border-red-100":s==="success"?"border-green-100":"border-yellow-100";return e.jsxs("div",{className:`${i} border ${m} rounded-md flex items-start justify-between mb-4`,children:[e.jsxs("div",{className:"flex items-start p-3",children:[s==="error"||s==="warning"?e.jsx(z,{className:`w-4 h-4 ${l} mr-2 mt-0.5`}):e.jsx(U,{className:`w-4 h-4 ${l} mr-2 mt-0.5`}),e.jsx("p",{className:`text-xs ${l}`,children:o})]}),c&&e.jsx("button",{onClick:c,className:`p-4 ${l} hover:bg-opacity-10 cursor-pointer rounded-full`,children:e.jsx(Q,{className:"w-4 h-4"})})]})},ie=({children:s,isOpen:o,onClose:c})=>{const i=r.useRef(null);return r.useEffect(()=>{const l=m=>{i.current&&m.target instanceof Node&&!i.current.contains(m.target)&&c()};return o&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[o,c]),o?e.jsx("div",{ref:i,className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden transform transition-all duration-150 ease-spring origin-top-right z-20 animate-scale-in",children:s}):null},oe=({icon:s,label:o,onClick:c,disabled:i=!1})=>e.jsxs("button",{onClick:c,disabled:i,className:"w-full text-left px-4 py-2.5 text-sm transition duration-150 text-gray-700 hover:bg-gray-50 active:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[s&&e.jsx(s,{className:"mr-2 h-4 w-4 text-gray-500"}),e.jsx("span",{children:o})]}),le=({server:s,projects:o,onProjectSelect:c,onBack:i})=>e.jsxs("div",{className:"animate-slide-in",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 border-b border-gray-100",children:[e.jsx("button",{onClick:i,className:"p-1.5 rounded-md hover:bg-gray-100 active:bg-gray-200 transition-colors mr-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-600",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Move to project"})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto py-1",children:o.map(l=>e.jsxs("button",{onClick:()=>c(l.id),disabled:l.id===s.projectId,className:`w-full text-left px-4 py-2.5 text-sm transition-colors duration-150 flex items-center
              ${l.id===s.projectId?"text-gray-400 cursor-not-allowed bg-gray-50":"text-gray-700 hover:bg-gray-50 active:bg-gray-100"}`,children:[e.jsx("span",{children:l.name}),l.id===s.projectId&&e.jsx("span",{className:"ml-auto text-xs text-gray-400",children:"(Current)"})]},l.id))})]});function fe(){const{currentProject:s,projects:o,moveServerToProject:c}=_(),[i,l]=r.useState([]),[m,v]=r.useState([]),[b,d]=r.useState(!0),[x,u]=r.useState(null),[p,M]=r.useState("servers"),[f,y]=r.useState({open:!1,serverId:null,mode:"main"}),[D,T]=r.useState(!1),[C,N]=r.useState(null),[P,B]=r.useState(!1);console.log(D);const[j,L]=r.useState({width:0,height:0,top:0,left:0,opacity:0}),S=r.useRef({}),w=r.useRef(null),R=r.useCallback((t,n)=>{S.current[t]=n},[]);r.useEffect(()=>{const n=requestAnimationFrame(()=>{const a=S.current[p];if(!a||!w.current)return;const h=a.getBoundingClientRect(),g=w.current.getBoundingClientRect(),$=h.left-g.left;L({width:h.width,height:h.height,top:3.5,left:$,opacity:1})});return()=>cancelAnimationFrame(n)},[p]),r.useEffect(()=>{const t=setTimeout(()=>{const n=S.current[p];if(!n||!w.current)return;const a=n.getBoundingClientRect(),h=w.current.getBoundingClientRect(),g=a.left-h.left;L({width:a.width,height:a.height,top:3.5,left:g,opacity:1})},50);return()=>clearTimeout(t)},[]);const A=r.useCallback(({id:t,isActive:n,onClick:a,children:h})=>{const g=r.useRef(null);return r.useEffect(()=>(g.current&&R(t,g.current),()=>{R(t,null)}),[t]),e.jsx("button",{ref:g,onClick:a,className:`tab-button relative z-5 cursor-pointer px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 outline-none focus:outline-none focus:ring-0 ${n?"text-gray-800 border-none":"text-gray-500 border-none hover:text-gray-700 hover:bg-gray-50"}`,children:h})},[R]);r.useEffect(()=>{E()},[]),r.useEffect(()=>{if(s&&i.length>0){const t=i.filter(n=>n.projectId===s.id);v(t)}else v(i)},[s,i]),r.useEffect(()=>{if(m.length>0){const t=m.some(n=>{var a;return!((a=n.status)!=null&&a.id)});B(t)}},[m]);const k={total:m.length,online:m.filter(t=>{var n,a;return((a=(n=t.status)==null?void 0:n.status)==null?void 0:a.state)==="running"}).length,offline:m.filter(t=>{var n,a;return((a=(n=t.status)==null?void 0:n.status)==null?void 0:a.state)!=="running"}).length},O=t=>{y({open:!0,serverId:t,mode:"main"})},Z=()=>{y({open:!1,serverId:null,mode:"main"})},V=()=>{y(t=>({...t,mode:"project-picker"}))},W=()=>{y(t=>({...t,mode:"main"}))},X=async t=>{if(f.serverId)try{T(!0),await c(f.serverId,t),l(n=>n.map(a=>a.id===f.serverId?{...a,projectId:t}:a)),y({open:!1,serverId:null,mode:"main"}),N("Server moved to project successfully"),setTimeout(()=>{N(null)},3e3)}catch(n){console.error("Failed to move server:",n),N(null),u(n instanceof Error?n.message:"Failed to move server"),setTimeout(()=>{u(null)},3e3)}finally{T(!1)}},E=async()=>{try{d(!0);const t=localStorage.getItem("token"),n=await fetch("/api/servers",{headers:{Authorization:`Bearer ${t}`}});if(!n.ok)throw new Error("Failed to fetch servers");const a=await n.json();l(a),u(null)}catch(t){u(t instanceof Error?t.message:"An error occurred")}finally{d(!1)}},H=()=>f.serverId&&i.find(t=>t.id===f.serverId)||null;return b?e.jsx(q,{}):x&&!C?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-red-600 text-sm",children:["Failed to load servers: ",x]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"w-full mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"Servers"}),s&&e.jsx("p",{className:"text-sm text-gray-500",children:s.isDefault?"Showing all servers in the Default project":`Showing servers in ${s.name} project`})]}),e.jsxs("button",{onClick:E,className:"flex items-center px-4 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 transition-colors duration-150",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),C&&e.jsx(I,{type:"success",message:C,onDismiss:()=>N(null)}),P&&e.jsx(I,{type:"warning",message:"One or more servers' nodes couldn't be reached. They may be inaccessible as a result. If so, you should probably contact an administrator. This is unlikely to be a problem with your network in this scenario.",onDismiss:()=>B(!1)}),x&&e.jsx(I,{type:"error",message:x,onDismiss:()=>u(null)}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{ref:w,className:"inline-flex p-1 space-x-1 bg-gray-100 rounded-lg relative",children:[e.jsx("div",{className:"absolute transform transition-all duration-200 ease-spring bg-white rounded-md shadow-xs border border-gray-200/50 z-0",style:{width:`${j.width}px`,height:`${j.height}px`,top:`${j.top}px`,left:`${j.left}px`,opacity:j.opacity,transitionDelay:"30ms"}}),e.jsxs(A,{id:"servers",isActive:p==="servers",onClick:()=>M("servers"),children:["All servers ",e.jsx("span",{className:"text-gray-500 ml-0.5",children:k.total})]}),e.jsx(A,{id:"overview",isActive:p==="overview",onClick:()=>M("overview"),children:"Overview"})]})}),p==="servers"&&e.jsx("div",{children:m.length>0?e.jsx("div",{className:"space-y-1.5",children:m.map(t=>{var n,a,h,g;return e.jsx("div",{id:`server-${t.id}`,className:"block bg-white rounded-md border border-gray-200 shadow-xs overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(G,{to:`/servers/${t.id}/console`,className:"px-3 py-3 flex-grow flex items-center justify-between hover:bg-gray-50 transition-colors duration-150",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${((a=(n=t.status)==null?void 0:n.status)==null?void 0:a.state)==="running"?"bg-green-400":"bg-gray-300"}`})}),e.jsxs("div",{className:"min-w-0 flex items-center",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",children:t.name}),!((h=t.status)!=null&&h.id)&&e.jsx(ae,{content:"Node connection issue. Server may be inaccessible.",position:"top",children:e.jsx(z,{className:"ml-2 h-3.5 w-3.5 text-amber-500"})}),e.jsx("div",{className:"text-[11px] text-gray-500 ml-1",children:((g=t.status)==null?void 0:g.id)||"Connection error"})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.cpuPercent,"%"]})," CPU limit"]}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[(t.memoryMiB/1024).toFixed(2)," GiB"]})," Memory limit"]})]}),e.jsx(J,{className:"h-3.5 w-3.5 text-gray-400"})]})]}),o.length>1&&e.jsx("div",{className:"relative h-full",children:e.jsx("button",{onClick:$=>{$.stopPropagation(),O(t.id)},className:"h-full px-3 border-l border-gray-200 text-gray-400 cursor-pointer hover:text-gray-600 hover:bg-gray-50 transition-colors duration-150 flex items-center","aria-label":"Server options",children:e.jsx(se,{className:"w-4 h-4"})})})]})},t.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-xl mb-6 flex items-center justify-center",children:e.jsx(ne,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:s!=null&&s.isDefault?"No servers found":`No servers in ${s==null?void 0:s.name}`}),e.jsx("p",{className:"text-gray-500 text-center max-w-md mb-6",children:s!=null&&s.isDefault?"You don't have any active servers yet. To create a new server, please contact your administrator.":"There are no servers in this project yet. You can move servers here from other projects."}),e.jsxs("button",{onClick:E,className:"flex items-center justify-center border border-gray-300/50 rounded-lg px-4 py-2 text-xs font-medium text-gray-700 hover:bg-gray-50 transition duration-150",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Refresh server list"]})]})}),f.open&&f.serverId&&e.jsx("div",{className:"fixed inset-0 z-50 pointer-events-none",children:e.jsx("div",{className:"absolute right-0 top-0 mt-1 pointer-events-auto",style:{position:"fixed",top:(()=>{const t=document.getElementById(`server-${f.serverId}`);return t?`${t.getBoundingClientRect().bottom}px`:"0px"})(),right:(()=>{const t=document.getElementById(`server-${f.serverId}`);if(t){const n=t.getBoundingClientRect();return`${window.innerWidth-n.right}px`}return"0px"})()},children:e.jsx(ie,{isOpen:f.open,onClose:Z,children:f.mode==="main"?e.jsx("div",{className:"py-1 animate-fade-in",children:e.jsx(oe,{icon:K,label:"Move to project",onClick:V})}):e.jsx(le,{server:H(),projects:o,onProjectSelect:X,onBack:W,currentProjectId:(s==null?void 0:s.id)||""})})})}),p==="overview"&&e.jsx("div",{className:"",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Total servers in Project"}),e.jsx("div",{className:"text-2xl font-medium",children:k.total})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Online"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-400 mr-2"}),e.jsx("div",{className:"text-2xl font-medium",children:k.online})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Offline"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 mr-2"}),e.jsx("div",{className:"text-2xl font-medium",children:k.offline})]})]})]})})]}),e.jsx("style",{children:`
        /* Custom optimized spring easing function */
        .ease-spring { 
          transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1.2); 
        }
        
        /* Remove white flash on active/focus for tab buttons */
        .tab-button:focus-visible {
          outline: none;
          border-color: transparent;
        }
        
        .tab-button {
          -webkit-tap-highlight-color: transparent;
        }
        
        /* Animation keyframes */
        @keyframes scale-in {
          0% { opacity: 0; transform: scale(0.95); }
          100% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes fade-in {
          0% { opacity: 0; }
          100% { opacity: 1; }
        }
        
        @keyframes slide-in {
          0% { transform: translateX(20px); opacity: 0; }
          100% { transform: translateX(0); opacity: 1; }
        }
        
        /* Animation classes */
        .animate-scale-in {
          animation: scale-in 0.15s ease-out forwards;
        }
        
        .animate-fade-in {
          animation: fade-in 0.1s ease-out forwards;
        }
        
        .animate-slide-in {
          animation: slide-in 0.2s ease-out forwards;
        }
      `})]})}export{fe as default};
