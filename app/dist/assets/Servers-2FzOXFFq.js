import{r,u as I,j as e,L as Z,a as D}from"./main-QCDkhjA5.js";import{C as B}from"./chevron-right-CiWzHrQ_.js";import{F as P}from"./folder-THtQg7yC.js";import{T as O}from"./triangle-alert-DRvvBewE.js";import{C as V}from"./check-DaWRW9TT.js";import{X as $}from"./x-BL17sks9.js";function z({title:s,titleId:n,...l},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":n},l),s?r.createElement("title",{id:n},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const C=r.forwardRef(z);function Y({title:s,titleId:n,...l},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":n},l),s?r.createElement("title",{id:n},s):null,r.createElement("path",{fillRule:"evenodd",d:"M11.622 1.602a.75.75 0 0 1 .756 0l2.25 1.313a.75.75 0 0 1-.756 1.295L12 3.118 10.128 4.21a.75.75 0 1 1-.756-1.295l2.25-1.313ZM5.898 5.81a.75.75 0 0 1-.27 1.025l-1.14.665 1.14.665a.75.75 0 1 1-.756 1.295L3.75 8.806v.944a.75.75 0 0 1-1.5 0V7.5a.75.75 0 0 1 .372-.648l2.25-1.312a.75.75 0 0 1 1.026.27Zm12.204 0a.75.75 0 0 1 1.026-.27l2.25 1.312a.75.75 0 0 1 .372.648v2.25a.75.75 0 0 1-1.5 0v-.944l-1.122.654a.75.75 0 1 1-.756-1.295l1.14-.665-1.14-.665a.75.75 0 0 1-.27-1.025Zm-9 5.25a.75.75 0 0 1 1.026-.27L12 11.882l1.872-1.092a.75.75 0 1 1 .756 1.295l-1.878 1.096V15a.75.75 0 0 1-1.5 0v-1.82l-1.878-1.095a.75.75 0 0 1-.27-1.025ZM3 13.5a.75.75 0 0 1 .75.75v1.82l1.878 1.095a.75.75 0 1 1-.756 1.295l-2.25-1.312a.75.75 0 0 1-.372-.648v-2.25A.75.75 0 0 1 3 13.5Zm18 0a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-.372.648l-2.25 1.312a.75.75 0 1 1-.756-1.295l1.878-1.096V14.25a.75.75 0 0 1 .75-.75Zm-9 5.25a.75.75 0 0 1 .75.75v.944l1.122-.654a.75.75 0 1 1 .756 1.295l-2.25 1.313a.75.75 0 0 1-.756 0l-2.25-1.313a.75.75 0 1 1 .756-1.295l1.122.654V19.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const G=r.forwardRef(Y),H=({isOpen:s,onClose:n,title:l,children:i,maxWidth:o="max-w-md"})=>{const d=r.useRef(null);return r.useEffect(()=>{const u=x=>{d.current&&x.target instanceof Node&&!d.current.contains(x.target)&&n()},h=x=>{x.key==="Escape"&&n()};return s&&(document.addEventListener("mousedown",u),document.addEventListener("keydown",h),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",u),document.removeEventListener("keydown",h),document.body.style.overflow="auto"}},[s,n]),s?e.jsx("div",{className:"fixed inset-0 bg-gray-100 bg-opacity-50 z-50 flex items-center justify-center p-4 transition-opacity duration-200 ease-in-out animate-fade-in",children:e.jsxs("div",{ref:d,className:`bg-white rounded-lg shadow-xs w-full ${o} transform transition-all duration-200 ease-in-out animate-scale-in`,children:[e.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:l}),e.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors duration-150",children:e.jsx($,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"px-6 py-4",children:i})]})}):null},L=({type:s,message:n,onDismiss:l})=>{const i=s==="error"?"bg-red-50":s==="success"?"bg-green-50":"bg-yellow-50",o=s==="error"?"text-red-600":s==="success"?"text-green-600":"text-yellow-600",d=s==="error"?"border-red-100":s==="success"?"border-green-100":"border-yellow-100";return e.jsxs("div",{className:`${i} border ${d} rounded-md flex items-start justify-between mb-4`,children:[e.jsxs("div",{className:"flex items-start p-3",children:[s==="error"||s==="warning"?e.jsx(O,{className:`w-4 h-4 ${o} mr-2 mt-0.5`}):e.jsx(V,{className:`w-4 h-4 ${o} mr-2 mt-0.5`}),e.jsx("p",{className:`text-xs ${o}`,children:n})]}),l&&e.jsx("button",{onClick:l,className:`p-2 ${o} hover:bg-opacity-10 cursor-pointer rounded-full`,children:e.jsx($,{className:"w-4 h-4"})})]})},U=({isOpen:s,onClose:n,server:l,onMove:i,projects:o,currentProjectId:d,isSubmitting:u,error:h})=>{const[x,g]=r.useState("");return r.useEffect(()=>{if(s&&o.length>0){const m=o.find(v=>v.id!==d);m?g(m.id):o.length>0&&g(o[0].id)}},[s,o,d]),!s||!l?null:e.jsxs(H,{isOpen:s,onClose:n,title:"Move Server to Project",children:[h&&e.jsx(L,{type:"error",message:h}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Move ",e.jsx("span",{className:"font-medium",children:l.name})," to another project"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Select Project"}),e.jsx("select",{value:x,onChange:m=>g(m.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-gray-400",children:o.map(m=>e.jsxs("option",{value:m.id,disabled:m.id===l.projectId,children:[m.name," ",m.id===l.projectId?"(Current)":""]},m.id))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 transition-colors duration-150",disabled:u,children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>i(x),disabled:u||x===l.projectId,className:"px-4 py-2 text-xs font-medium text-white bg-gray-900 border border-transparent rounded-md hover:bg-gray-800 focus:outline-none transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Moving...":"Move Server"})]})]})};function _(){const{currentProject:s,projects:n,moveServerToProject:l}=I(),[i,o]=r.useState([]),[d,u]=r.useState([]),[h,x]=r.useState(!0),[g,m]=r.useState(null),[v,S]=r.useState("servers"),[R,j]=r.useState(!1),[f,p]=r.useState(null),[F,k]=r.useState(!1),[T,b]=r.useState(null),[E,N]=r.useState(null);r.useEffect(()=>{w()},[]),r.useEffect(()=>{if(s&&i.length>0){const t=i.filter(a=>a.projectId===s.id);u(t)}else u(i)},[s,i]);const y={total:d.length,online:d.filter(t=>{var a,c;return((c=(a=t.status)==null?void 0:a.status)==null?void 0:c.state)==="running"}).length,offline:d.filter(t=>{var a,c;return((c=(a=t.status)==null?void 0:a.status)==null?void 0:c.state)!=="running"}).length},A=async t=>{if(f)try{b(null),k(!0),await l(f.id,t),o(a=>a.map(c=>c.id===f.id?{...c,projectId:t}:c)),j(!1),p(null),N("Server moved to project successfully"),setTimeout(()=>{N(null)},3e3)}catch(a){console.error("Failed to move server:",a),b(a instanceof Error?a.message:"Failed to move server")}finally{k(!1)}},w=async()=>{try{x(!0);const t=localStorage.getItem("token"),a=await fetch("/api/servers",{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error("Failed to fetch servers");const c=await a.json();o(c),m(null)}catch(t){m(t instanceof Error?t.message:"An error occurred")}finally{x(!1)}};return h?e.jsx(Z,{}):g?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-red-600 text-sm",children:["Failed to load servers: ",g]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"w-full mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"Servers"}),s&&e.jsx("p",{className:"text-sm text-gray-500",children:s.isDefault?"Showing all servers in the Default project":`Showing servers in ${s.name} project`})]}),e.jsxs("button",{onClick:w,className:"flex items-center px-4 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 transition-colors duration-150",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),E&&e.jsx(L,{type:"success",message:E,onDismiss:()=>N(null)}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"inline-flex p-1 space-x-1 bg-gray-100 rounded-lg",children:[e.jsxs("button",{onClick:()=>S("servers"),className:`px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 ${v==="servers"?"bg-white text-gray-800 border border-gray-200/50 shadow-xs":"text-gray-500 border border-transparent hover:text-gray-700 hover:bg-gray-50"}`,children:["All servers ",e.jsx("span",{className:"text-gray-500 ml-0.5",children:y.total})]}),e.jsx("button",{onClick:()=>S("overview"),className:`px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 ${v==="overview"?"bg-white text-gray-800 border border-gray-200/50  shadow-xs":"text-gray-500 border border-transparent hover:text-gray-700 hover:bg-gray-50"}`,children:"Overview"})]})}),v==="servers"&&e.jsx("div",{children:d.length>0?e.jsx("div",{className:"space-y-1.5",children:d.map(t=>{var a,c,M;return e.jsx("div",{className:"block bg-white rounded-md border border-gray-200 shadow-xs overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(D,{to:`/servers/${t.id}/console`,className:"px-3 py-3 flex-grow flex items-center justify-between hover:bg-gray-50 transition-colors duration-150",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${((c=(a=t.status)==null?void 0:a.status)==null?void 0:c.state)==="running"?"bg-green-400":"bg-gray-300"}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",children:t.name}),e.jsx("div",{className:"text-[11px] text-gray-500",children:(M=t.status)==null?void 0:M.id})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.cpuPercent,"%"]})," CPU limit"]}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[(t.memoryMiB/1024).toFixed(2)," GiB"]})," Memory limit"]})]}),e.jsx(B,{className:"h-3.5 w-3.5 text-gray-400"})]})]}),n.length>1&&e.jsx("button",{onClick:()=>{p(t),b(null),j(!0)},className:"h-full px-3 border-l border-gray-200 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors duration-150",title:"Move to different project",children:e.jsx(P,{className:"w-4 h-4"})})]})},t.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-xl mb-6",children:e.jsx(G,{className:"w-8 h-8 text-gray-400 mx-auto mt-4.25"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:s!=null&&s.isDefault?"No servers found":`No servers in ${s==null?void 0:s.name}`}),e.jsx("p",{className:"text-gray-500 text-center max-w-md mb-6",children:s!=null&&s.isDefault?"You don't have any active servers yet. To create a new server, please contact your administrator.":"There are no servers in this project yet. You can move servers here from other projects."}),e.jsxs("button",{onClick:w,className:"flex items-center justify-center border border-gray-300/50 rounded-lg px-4 py-2 text-xs font-medium text-gray-700 hover:bg-gray-50 transition duration-150",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Refresh server list"]})]})}),v==="overview"&&e.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:s?`${s.name} Project Overview`:"Server Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Total Servers"}),e.jsx("div",{className:"text-2xl font-medium",children:y.total})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Online"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-400 mr-2"}),e.jsx("div",{className:"text-2xl font-medium",children:y.online})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Offline"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 mr-2"}),e.jsx("div",{className:"text-2xl font-medium",children:y.offline})]})]})]}),s&&s.description&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Project Description"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})]})]}),e.jsx(U,{isOpen:R,onClose:()=>{j(!1),p(null),b(null)},server:f,onMove:A,projects:n,currentProjectId:(s==null?void 0:s.id)||null,isSubmitting:F,error:T})]})}export{_ as default};
