import{r as s,u as Y,j as e,L as q,a as G}from"./main-RYK7rxBo.js";import{C as H}from"./chevron-right-DxfyOig3.js";import{F as U}from"./folder-CXrzSZFy.js";import{T as W}from"./triangle-alert-zWRf1m5b.js";import{C as X}from"./check-DyjcSRO3.js";import{X as B}from"./x-CYVRHKZw.js";function J({title:t,titleId:i,...o},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":i},o),t?s.createElement("title",{id:i},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const I=s.forwardRef(J);function K({title:t,titleId:i,...o},c){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":i},o),t?s.createElement("title",{id:i},t):null,s.createElement("path",{fillRule:"evenodd",d:"M11.622 1.602a.75.75 0 0 1 .756 0l2.25 1.313a.75.75 0 0 1-.756 1.295L12 3.118 10.128 4.21a.75.75 0 1 1-.756-1.295l2.25-1.313ZM5.898 5.81a.75.75 0 0 1-.27 1.025l-1.14.665 1.14.665a.75.75 0 1 1-.756 1.295L3.75 8.806v.944a.75.75 0 0 1-1.5 0V7.5a.75.75 0 0 1 .372-.648l2.25-1.312a.75.75 0 0 1 1.026.27Zm12.204 0a.75.75 0 0 1 1.026-.27l2.25 1.312a.75.75 0 0 1 .372.648v2.25a.75.75 0 0 1-1.5 0v-.944l-1.122.654a.75.75 0 1 1-.756-1.295l1.14-.665-1.14-.665a.75.75 0 0 1-.27-1.025Zm-9 5.25a.75.75 0 0 1 1.026-.27L12 11.882l1.872-1.092a.75.75 0 1 1 .756 1.295l-1.878 1.096V15a.75.75 0 0 1-1.5 0v-1.82l-1.878-1.095a.75.75 0 0 1-.27-1.025ZM3 13.5a.75.75 0 0 1 .75.75v1.82l1.878 1.095a.75.75 0 1 1-.756 1.295l-2.25-1.312a.75.75 0 0 1-.372-.648v-2.25A.75.75 0 0 1 3 13.5Zm18 0a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-.372.648l-2.25 1.312a.75.75 0 1 1-.756-1.295l1.878-1.096V14.25a.75.75 0 0 1 .75-.75Zm-9 5.25a.75.75 0 0 1 .75.75v.944l1.122-.654a.75.75 0 1 1 .756 1.295l-2.25 1.313a.75.75 0 0 1-.756 0l-2.25-1.313a.75.75 0 1 1 .756-1.295l1.122.654V19.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"}))}const Q=s.forwardRef(K),_=({isOpen:t,onClose:i,title:o,children:c,maxWidth:l="max-w-md"})=>{const d=s.useRef(null);return s.useEffect(()=>{const f=u=>{d.current&&u.target instanceof Node&&!d.current.contains(u.target)&&i()},g=u=>{u.key==="Escape"&&i()};return t&&(document.addEventListener("mousedown",f),document.addEventListener("keydown",g),document.body.style.overflow="hidden"),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",g),document.body.style.overflow="auto"}},[t,i]),t?e.jsx("div",{className:"fixed inset-0 bg-gray-100 bg-opacity-50 z-50 flex items-center justify-center p-4 transition-opacity duration-200 ease-in-out animate-fade-in",children:e.jsxs("div",{ref:d,className:`bg-white rounded-lg shadow-xs w-full ${l} transform transition-all duration-200 ease-in-out animate-scale-in`,children:[e.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:o}),e.jsx("button",{onClick:i,className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors duration-150",children:e.jsx(B,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"px-6 py-4",children:c})]})}):null},D=({type:t,message:i,onDismiss:o})=>{const c=t==="error"?"bg-red-50":t==="success"?"bg-green-50":"bg-yellow-50",l=t==="error"?"text-red-600":t==="success"?"text-green-600":"text-yellow-600",d=t==="error"?"border-red-100":t==="success"?"border-green-100":"border-yellow-100";return e.jsxs("div",{className:`${c} border ${d} rounded-md flex items-start justify-between mb-4`,children:[e.jsxs("div",{className:"flex items-start p-3",children:[t==="error"||t==="warning"?e.jsx(W,{className:`w-4 h-4 ${l} mr-2 mt-0.5`}):e.jsx(X,{className:`w-4 h-4 ${l} mr-2 mt-0.5`}),e.jsx("p",{className:`text-xs ${l}`,children:i})]}),o&&e.jsx("button",{onClick:o,className:`p-2 ${l} hover:bg-opacity-10 cursor-pointer rounded-full`,children:e.jsx(B,{className:"w-4 h-4"})})]})},ee=({isOpen:t,onClose:i,server:o,onMove:c,projects:l,currentProjectId:d,isSubmitting:f,error:g})=>{const[u,b]=s.useState("");return s.useEffect(()=>{if(t&&l.length>0){const m=l.find(h=>h.id!==d);m?b(m.id):l.length>0&&b(l[0].id)}},[t,l,d]),!t||!o?null:e.jsxs(_,{isOpen:t,onClose:i,title:"Move Server to Project",children:[g&&e.jsx(D,{type:"error",message:g}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Move ",e.jsx("span",{className:"font-medium",children:o.name})," to another project"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Select Project"}),e.jsx("select",{value:u,onChange:m=>b(m.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-md focus:outline-none focus:ring-1 focus:ring-gray-400",children:l.map(m=>e.jsxs("option",{value:m.id,disabled:m.id===o.projectId,children:[m.name," ",m.id===o.projectId?"(Current)":""]},m.id))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 transition-colors duration-150",disabled:f,children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>c(u),disabled:f||u===o.projectId,className:"px-4 py-2 text-xs font-medium text-white bg-gray-900 border border-transparent rounded-md hover:bg-gray-800 focus:outline-none transition-colors duration-150 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Moving...":"Move Server"})]})]})};function oe(){const{currentProject:t,projects:i,moveServerToProject:o}=Y(),[c,l]=s.useState([]),[d,f]=s.useState([]),[g,u]=s.useState(!0),[b,m]=s.useState(null),[h,$]=s.useState("servers"),[Z,S]=s.useState(!1),[p,C]=s.useState(null),[z,L]=s.useState(!1),[P,w]=s.useState(null),[T,E]=s.useState(null),[y,F]=s.useState({width:0,height:0,top:0,left:0,opacity:0}),k=s.useRef({}),j=s.useRef(null),R=s.useCallback((r,a)=>{k.current[r]=a},[]);s.useEffect(()=>{const a=requestAnimationFrame(()=>{const n=k.current[h];if(!n||!j.current)return;const x=n.getBoundingClientRect(),v=j.current.getBoundingClientRect(),V=x.left-v.left;F({width:x.width,height:x.height,top:3.5,left:V,opacity:1})});return()=>cancelAnimationFrame(a)},[h]),s.useEffect(()=>{const r=setTimeout(()=>{const a=k.current[h];if(!a||!j.current)return;const n=a.getBoundingClientRect(),x=j.current.getBoundingClientRect(),v=n.left-x.left;F({width:n.width,height:n.height,top:3.5,left:v,opacity:1})},50);return()=>clearTimeout(r)},[]);const A=s.useCallback(({id:r,isActive:a,onClick:n,children:x})=>{const v=s.useRef(null);return s.useEffect(()=>(v.current&&R(r,v.current),()=>{R(r,null)}),[r]),e.jsx("button",{ref:v,onClick:n,className:`tab-button relative z-10 px-3 py-1 text-sm font-medium rounded-md transition-all duration-200 outline-none focus:outline-none focus:ring-0 ${a?"text-gray-800 border-none":"text-gray-500 border-none hover:text-gray-700 hover:bg-gray-50"}`,children:x})},[R]);s.useEffect(()=>{M()},[]),s.useEffect(()=>{if(t&&c.length>0){const r=c.filter(a=>a.projectId===t.id);f(r)}else f(c)},[t,c]);const N={total:d.length,online:d.filter(r=>{var a,n;return((n=(a=r.status)==null?void 0:a.status)==null?void 0:n.state)==="running"}).length,offline:d.filter(r=>{var a,n;return((n=(a=r.status)==null?void 0:a.status)==null?void 0:n.state)!=="running"}).length},O=async r=>{if(p)try{w(null),L(!0),await o(p.id,r),l(a=>a.map(n=>n.id===p.id?{...n,projectId:r}:n)),S(!1),C(null),E("Server moved to project successfully"),setTimeout(()=>{E(null)},3e3)}catch(a){console.error("Failed to move server:",a),w(a instanceof Error?a.message:"Failed to move server")}finally{L(!1)}},M=async()=>{try{u(!0);const r=localStorage.getItem("token"),a=await fetch("/api/servers",{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error("Failed to fetch servers");const n=await a.json();l(n),m(null)}catch(r){m(r instanceof Error?r.message:"An error occurred")}finally{u(!1)}};return g?e.jsx(q,{}):b?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-red-600 text-sm",children:["Failed to load servers: ",b]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"w-full mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"Servers"}),t&&e.jsx("p",{className:"text-sm text-gray-500",children:t.isDefault?"Showing all servers in the Default project":`Showing servers in ${t.name} project`})]}),e.jsxs("button",{onClick:M,className:"flex items-center px-4 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 transition-colors duration-150",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),T&&e.jsx(D,{type:"success",message:T,onDismiss:()=>E(null)}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{ref:j,className:"inline-flex p-1 space-x-1 bg-gray-100 rounded-lg relative",children:[e.jsx("div",{className:"absolute transform transition-all duration-200 ease-spring bg-white rounded-md shadow-xs border border-gray-200/50 z-0",style:{width:`${y.width}px`,height:`${y.height}px`,top:`${y.top}px`,left:`${y.left}px`,opacity:y.opacity,transitionDelay:"30ms"}}),e.jsxs(A,{id:"servers",isActive:h==="servers",onClick:()=>$("servers"),children:["All servers ",e.jsx("span",{className:"text-gray-500 ml-0.5",children:N.total})]}),e.jsx(A,{id:"overview",isActive:h==="overview",onClick:()=>$("overview"),children:"Overview"})]})}),h==="servers"&&e.jsx("div",{children:d.length>0?e.jsx("div",{className:"space-y-1.5",children:d.map(r=>{var a,n,x;return e.jsx("div",{className:"block bg-white rounded-md border border-gray-200 shadow-xs overflow-hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(G,{to:`/servers/${r.id}/console`,className:"px-3 py-3 flex-grow flex items-center justify-between hover:bg-gray-50 transition-colors duration-150",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${((n=(a=r.status)==null?void 0:a.status)==null?void 0:n.state)==="running"?"bg-green-400":"bg-gray-300"}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 truncate",children:r.name}),e.jsx("div",{className:"text-[11px] text-gray-500",children:(x=r.status)==null?void 0:x.id})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[r.cpuPercent,"%"]})," CPU limit"]}),e.jsxs("div",{className:"text-[11px] text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[(r.memoryMiB/1024).toFixed(2)," GiB"]})," Memory limit"]})]}),e.jsx(H,{className:"h-3.5 w-3.5 text-gray-400"})]})]}),i.length>1&&e.jsx("button",{onClick:()=>{C(r),w(null),S(!0)},className:"h-full px-3 border-l border-gray-200 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors duration-150",title:"Move to different project",children:e.jsx(U,{className:"w-4 h-4"})})]})},r.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-xl mb-6",children:e.jsx(Q,{className:"w-8 h-8 text-gray-400 mx-auto mt-4.25"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:t!=null&&t.isDefault?"No servers found":`No servers in ${t==null?void 0:t.name}`}),e.jsx("p",{className:"text-gray-500 text-center max-w-md mb-6",children:t!=null&&t.isDefault?"You don't have any active servers yet. To create a new server, please contact your administrator.":"There are no servers in this project yet. You can move servers here from other projects."}),e.jsxs("button",{onClick:M,className:"flex items-center justify-center border border-gray-300/50 rounded-lg px-4 py-2 text-xs font-medium text-gray-700 hover:bg-gray-50 transition duration-150",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Refresh server list"]})]})}),h==="overview"&&e.jsxs("div",{className:"bg-white rounded-md border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:t?`${t.name} Project Overview`:"Server Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Total Servers"}),e.jsx("div",{className:"text-2xl font-medium",children:N.total})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Online"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-400 mr-2"}),e.jsx("div",{className:"text-2xl font-medium",children:N.online})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-md p-4",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-1",children:"Offline"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 mr-2"}),e.jsx("div",{className:"text-2xl font-medium",children:N.offline})]})]})]}),t&&t.description&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Project Description"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description})]})]})]}),e.jsx(ee,{isOpen:Z,onClose:()=>{S(!1),C(null),w(null)},server:p,onMove:O,projects:i,currentProjectId:(t==null?void 0:t.id)||null,isSubmitting:z,error:P}),e.jsx("style",{children:`
        /* Custom optimized spring easing function - faster with subtle bounce */
        .ease-spring { 
          transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1.2); 
        }
        
        /* Remove white flash on active/focus for tab buttons */
        .tab-button:focus-visible {
          outline: none;
          border-color: transparent;
        }
        
        .tab-button {
          -webkit-tap-highlight-color: transparent;
        }
      `})]})}export{oe as default};
