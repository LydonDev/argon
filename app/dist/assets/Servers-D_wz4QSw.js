import{r as i,j as e,L as ge}from"./main-B9tY2GuM.js";import{A as Y}from"./AdminBar-A9fOcA8i.js";import{P as he,a as pe,T as ye}from"./trash-hHUHwusk.js";import{C as fe}from"./chevron-right-Bx33rvII.js";import{A as F}from"./arrow-left-D_5vR1uB.js";const we=()=>{const[S,G]=i.useState([]),[B,K]=i.useState([]),[N,Q]=i.useState([]),[R,X]=i.useState([]),[q,L]=i.useState([]),[Z,$]=i.useState(!0),[O,M]=i.useState(null),[y,x]=i.useState("list"),[r,f]=i.useState(null),[T,h]=i.useState([]),[z,j]=i.useState(!1),[u,D]=i.useState("nodes"),[_,V]=i.useState(!1),[d,E]=i.useState({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100}),[o,b]=i.useState({name:"",unitId:"",memoryMiB:0,diskMiB:0,cpuPercent:0}),[k,p]=i.useState(null),[P,ee]=i.useState(""),[v,J]=i.useState(""),[se,te]=i.useState([]),[H,ae]=i.useState([]),[U,A]=i.useState(!1);i.useEffect(()=>{d.unitId?re(d.unitId):(h([]),j(!1))},[d.unitId]),i.useEffect(()=>{w()},[]),i.useEffect(()=>{y==="create"&&ne()},[y]),i.useEffect(()=>{const t=R.filter(a=>a.username.toLowerCase().includes(P.toLowerCase()));te(t)},[P,R]),i.useEffect(()=>{const t=N.filter(a=>a.name.toLowerCase().includes(v.toLowerCase())||a.shortName.toLowerCase().includes(v.toLowerCase()));ae(t)},[v,N]);const re=async t=>{try{const a=localStorage.getItem("token"),l=await fetch(`/api/units/${t}/docker-images`,{headers:{Authorization:`Bearer ${a}`}});if(l.ok){const n=await l.json();if(n.dockerImages&&Array.isArray(n.dockerImages)&&n.dockerImages.length>0)h(n.dockerImages),j(!0),n.defaultDockerImage?m({dockerImage:n.defaultDockerImage}):m({dockerImage:n.dockerImages[0].image});else{const s=N.find(c=>c.id===t);s?(h([{image:s.dockerImage,displayName:"Default Image"}]),m({dockerImage:s.dockerImage})):h([]),j(!1)}}else{const n=N.find(s=>s.id===t);n?(h([{image:n.dockerImage,displayName:"Default Image"}]),m({dockerImage:n.dockerImage})):h([]),j(!1)}}catch(a){console.error("Failed to fetch unit Docker images:",a),h([]),j(!1)}},ne=async()=>{V(!0);try{const t=localStorage.getItem("token"),a=await fetch("/api/regions",{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error("Failed to fetch regions");const l=await a.json();L(l)}catch(t){console.error("Failed to fetch regions:",t),D("nodes")}finally{V(!1)}},w=async()=>{try{$(!0);const a={Authorization:`Bearer ${localStorage.getItem("token")}`},[l,n,s,c,g]=await Promise.all([fetch("/api/servers?include[node]=true&include[unit]=true&include[user]=true",{headers:a}),fetch("/api/nodes",{headers:a}),fetch("/api/units",{headers:a}),fetch("/api/users",{headers:a}),fetch("/api/regions",{headers:a})]);if(!l.ok)throw new Error("Failed to fetch servers");if(!n.ok)throw new Error("Failed to fetch nodes");if(!s.ok)throw new Error("Failed to fetch units");if(!c.ok)throw new Error("Failed to fetch users");const[I,C,xe,ue]=await Promise.all([l.json(),n.json(),s.json(),c.json()]);let W=[];g.ok&&(W=await g.json(),L(W)),G(I),K(C),Q(xe),X(ue),M(null)}catch(t){M(t instanceof Error?t.message:"An error occurred")}finally{$(!1)}},ie=async t=>{t.preventDefault(),p(null);try{const a={...d};!!a.regionId&&(delete a.nodeId,delete a.allocationId),a.startupCommand||delete a.startupCommand;const n=localStorage.getItem("token"),s=await fetch("/api/servers",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok){const c=await s.json();throw new Error(c.error||"Failed to create server")}await w(),x("list"),E({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100,regionId:"",dockerImage:"",startupCommand:""})}catch(a){p(a instanceof Error?a.message:"Failed to create server")}},de=async t=>{if(t.preventDefault(),!!r){p(null),A(!0);try{const a={};if(o.name!==r.name&&(a.name=o.name),o.unitId!==r.unitId&&(a.unitId=o.unitId),o.memoryMiB!==r.memoryMiB&&(a.memoryMiB=o.memoryMiB),o.diskMiB!==r.diskMiB&&(a.diskMiB=o.diskMiB),o.cpuPercent!==r.cpuPercent&&(a.cpuPercent=o.cpuPercent),Object.keys(a).length===0){x("view"),A(!1);return}const l=localStorage.getItem("token"),n=await fetch(`/api/servers/${r.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok){const c=await n.json();throw new Error(c.error||"Failed to update server")}await w();const s=S.find(c=>c.id===r.id);s&&f(s),x("view")}catch(a){p(a instanceof Error?a.message:"Failed to update server")}finally{A(!1)}}},le=async t=>{try{const a=localStorage.getItem("token"),l=await fetch(`/api/servers/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!l.ok){const n=await l.json();throw new Error(n.error||"Failed to delete server")}await w(),(r==null?void 0:r.id)===t&&(x("list"),f(null))}catch(a){M(a instanceof Error?a.message:"Failed to delete server")}},m=t=>{E(a=>({...a,...t}))},oe=()=>{var t,a,l,n;return e.jsxs("form",{onSubmit:ie,className:"space-y-4 max-w-lg",children:[k&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-red-600",children:k})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:d.name,onChange:s=>m({name:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"my-server",required:!0})]}),e.jsx("div",{className:"border-b border-gray-200 mb-2",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{type:"button",onClick:()=>D("nodes"),className:`pb-2 text-xs font-medium relative ${u==="nodes"?"text-gray-800 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:["Specific Node",u==="nodes"&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-indigo-600"})]}),e.jsxs("button",{type:"button",onClick:()=>D("regions"),className:`pb-2 ml-6 text-xs font-medium relative ${u==="regions"?"text-gray-800 border-indigo-600":"text-gray-500 hover:text-gray-700"}`,children:["Region (Load Balanced)",u==="regions"&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-indigo-600"})]})]})}),u==="nodes"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Node"}),e.jsxs("select",{value:d.nodeId||"",onChange:s=>m({nodeId:s.target.value,regionId:"",allocationId:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:u==="nodes",children:[e.jsx("option",{value:"",children:"Select a node"}),B.map(s=>e.jsxs("option",{value:s.id,disabled:!s.isOnline,children:[s.name," (",s.fqdn,") ",!s.isOnline&&"- Offline"]},s.id))]})]}),d.nodeId&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Port Allocation"}),e.jsxs("select",{value:d.allocationId||"",onChange:s=>m({allocationId:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:u==="nodes",children:[e.jsx("option",{value:"",children:"Select a port allocation"}),(a=(t=B.find(s=>s.id===d.nodeId))==null?void 0:t.allocations)==null?void 0:a.filter(s=>!s.assigned).map(s=>e.jsxs("option",{value:s.id,children:[s.bindAddress,":",s.port,s.alias&&` (${s.alias})`]},s.id))]}),((n=(l=B.find(s=>s.id===d.nodeId))==null?void 0:l.allocations)==null?void 0:n.filter(s=>!s.assigned).length)===0&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"No available allocations on this node. Please select a different node or create allocations."})]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Region"}),_?e.jsxs("div",{className:"flex items-center space-x-2 py-2",children:[e.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-gray-500 rounded-full border-t-transparent"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Loading regions..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:d.regionId||"",onChange:s=>m({regionId:s.target.value,nodeId:"",allocationId:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:u==="regions",children:[e.jsx("option",{value:"",children:"Select a region"}),q.map(s=>{var c,g,I,C;return e.jsxs("option",{value:s.id,disabled:((c=s.stats)==null?void 0:c.onlineNodeCount)===0||((g=s.stats)==null?void 0:g.atCapacity),children:[s.name,((I=s.stats)==null?void 0:I.onlineNodeCount)===0?" (No online nodes)":"",(C=s.stats)!=null&&C.atCapacity?" (At capacity)":""]},s.id)})]}),q.length===0&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No regions configured. Please create a region first or select a specific node."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Argon will automatically select the best node in this region"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Unit"}),e.jsx("input",{type:"text",value:v,onChange:s=>J(s.target.value),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400 mb-2",placeholder:"Search units..."}),e.jsxs("select",{value:d.unitId,onChange:s=>m({unitId:s.target.value,dockerImage:""}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:[e.jsx("option",{value:"",children:"Select a unit"}),H.map(s=>{var c;return e.jsxs("option",{value:s.id,children:[s.name," (",s.shortName,") ",((c=s.meta)==null?void 0:c.version)==="argon/unit:v3"?"(v3)":""]},s.id)})]})]}),d.unitId&&T.length>1&&z&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Docker Image"}),e.jsxs("select",{value:d.dockerImage,onChange:s=>m({dockerImage:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:[e.jsx("option",{value:"",children:"Select a Docker image"}),T.map((s,c)=>e.jsxs("option",{value:s.image,children:[s.displayName," (",s.image,")"]},c))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a Docker image for this server. Each image may offer different versions or features."})]}),d.unitId&&z&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Startup Command (Optional)"}),e.jsx("input",{type:"text",value:d.startupCommand||"",onChange:s=>m({startupCommand:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"Leave blank to use unit default"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Customize the startup command or leave blank to use the unit's default."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"User"}),e.jsx("input",{type:"text",value:P,onChange:s=>ee(s.target.value),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400 mb-2",placeholder:"Search users..."}),e.jsxs("select",{value:d.userId,onChange:s=>m({userId:s.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:[e.jsx("option",{value:"",children:"Select a user"}),se.map(s=>e.jsx("option",{value:s.id,children:s.username},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Memory (MiB)"}),e.jsx("input",{type:"number",value:d.memoryMiB,onChange:s=>m({memoryMiB:parseInt(s.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:128,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Disk (MiB)"}),e.jsx("input",{type:"number",value:d.diskMiB,onChange:s=>m({diskMiB:parseInt(s.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:1024,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"CPU (%)"}),e.jsx("input",{type:"number",value:d.cpuPercent,onChange:s=>m({cpuPercent:parseInt(s.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:25,max:400,required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"submit",className:"px-3 py-2 text-xs font-medium text-white bg-gray-900 rounded-md hover:bg-gray-800",disabled:u==="nodes"&&(!d.nodeId||!d.allocationId)||u==="regions"&&!d.regionId,children:"Create Server"}),e.jsx("button",{type:"button",onClick:()=>{x("list"),f(null),E({name:"",nodeId:"",unitId:"",userId:"",allocationId:"",memoryMiB:1024,diskMiB:10240,cpuPercent:100,regionId:""})},className:"px-3 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:"Cancel"})]})]})},ce=()=>r?e.jsxs("form",{onSubmit:de,className:"space-y-4 max-w-lg",children:[k&&e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-md p-3",children:e.jsx("p",{className:"text-xs text-red-600",children:k})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:t=>b({...o,name:t.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",placeholder:"my-server",required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Unit"}),e.jsx("input",{type:"text",value:v,onChange:t=>J(t.target.value),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400 mb-2",placeholder:"Search units..."}),e.jsx("select",{value:o.unitId,onChange:t=>b({...o,unitId:t.target.value}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",required:!0,children:H.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.shortName,")"]},t.id))}),o.unitId!==r.unitId&&e.jsx("p",{className:"mt-2 text-yellow-600 text-xs",children:"Warning: Changing the unit will reinstall the server with the new image. Your server data will be preserved, but the environment will change."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Memory (MiB)"}),e.jsx("input",{type:"number",value:o.memoryMiB,onChange:t=>b({...o,memoryMiB:parseInt(t.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:128,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Disk (MiB)"}),e.jsx("input",{type:"number",value:o.diskMiB,onChange:t=>b({...o,diskMiB:parseInt(t.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:1024,required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"CPU (%)"}),e.jsx("input",{type:"number",value:o.cpuPercent,onChange:t=>b({...o,cpuPercent:parseInt(t.target.value)}),className:"block w-full px-3 py-2 text-xs border border-gray-200 rounded-md focus:outline-none focus:border-gray-400",min:25,max:400,required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{type:"submit",disabled:U,className:"px-3 py-2 text-xs font-medium text-white bg-gray-900 rounded-md hover:bg-gray-800 disabled:bg-gray-400",children:U?"Updating...":"Update Server"}),e.jsx("button",{type:"button",disabled:U,onClick:()=>{x("view"),p(null)},className:"px-3 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50 disabled:bg-gray-100",children:"Cancel"})]})]}):null,me=()=>{var a,l,n,s,c,g;if(!r)return null;const t=(a=r.node)==null?void 0:a.region;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{x("list"),f(null)},className:"flex items-center text-gray-600 hover:bg-gray-100 p-2 cursor-pointer rounded-md transition hover:text-gray-900",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:r.name}),e.jsx("p",{className:"text-xs text-gray-500",children:r.internalId})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>{b({name:r.name,unitId:r.unitId,memoryMiB:r.memoryMiB,diskMiB:r.diskMiB,cpuPercent:r.cpuPercent}),p(null),x("edit")},className:"flex items-center px-3 py-2 text-xs font-medium text-gray-600 bg-white border border-gray-200 rounded-md hover:bg-gray-50",children:[e.jsx(pe,{className:"w-3.5 h-3.5 mr-1.5"}),"Edit"]}),e.jsxs("button",{onClick:()=>le(r.id),className:"flex items-center px-3 py-2 text-xs font-medium text-red-600 bg-white border border-gray-200 rounded-md hover:bg-red-50",children:[e.jsx(ye,{className:"w-3.5 h-3.5 mr-1.5"}),"Delete"]})]})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-md shadow-xs",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Server ID"}),e.jsx("div",{className:"text-sm font-mono mt-1",children:r.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Name"}),e.jsx("div",{className:"text-sm mt-1",children:r.name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Internal ID"}),e.jsx("div",{className:"text-sm mt-1",children:r.internalId})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Current State"}),e.jsx("div",{className:"text-sm mt-1",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.state==="running"?"bg-green-100 text-green-800":r.state==="updating"?"bg-yellow-100 text-yellow-800":r.state==="stopping"?"bg-orange-100 text-orange-800":r.state==="starting"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:r.state})})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 mb-3",children:"Resources"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Memory"}),e.jsxs("div",{className:"text-sm mt-1",children:[r.memoryMiB," MiB"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Disk"}),e.jsxs("div",{className:"text-sm mt-1",children:[r.diskMiB," MiB"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"CPU"}),e.jsxs("div",{className:"text-sm mt-1",children:[r.cpuPercent,"%"]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs font-medium text-gray-900 mb-3",children:"Relationships"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Node"}),e.jsxs("div",{className:"text-sm mt-1",children:[(l=r.node)==null?void 0:l.name," (",(n=r.node)==null?void 0:n.fqdn,")"]})]}),t&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Region"}),e.jsxs("div",{className:"text-sm mt-1",children:[t.name," (",t.identifier,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Unit"}),e.jsxs("div",{className:"text-sm mt-1",children:[(s=r.unit)==null?void 0:s.name," (",(c=r.unit)==null?void 0:c.shortName,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"User"}),e.jsx("div",{className:"text-sm mt-1",children:(g=r.user)==null?void 0:g.username})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Created At"}),e.jsx("div",{className:"text-sm mt-1",children:new Date(r.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Updated At"}),e.jsx("div",{className:"text-sm mt-1",children:new Date(r.updatedAt).toLocaleString()})]})]})})})]})};return Z?e.jsx(ge,{}):O?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Y,{}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-red-600 text-xs",children:["Error: ",O]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Y,{}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"transition-all duration-200 ease-in-out",children:[y==="list"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Servers"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage all servers running on your nodes."})]}),e.jsxs("button",{onClick:()=>x("create"),className:"flex items-center px-3 py-2 text-xs font-medium text-white bg-gray-900 rounded-md hover:bg-gray-800",children:[e.jsx(he,{className:"w-3.5 h-3.5 mr-1.5"}),"Create Server"]})]}),e.jsxs("div",{className:"space-y-2",children:[S.map(t=>{var a,l,n;return e.jsx("div",{className:"bg-white border border-gray-200 rounded-md shadow-xs cursor-pointer hover:border-gray-300",onClick:()=>{f(t),x("view")},children:e.jsxs("div",{className:"px-6 h-20 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-2 w-2 rounded-full ${t.state==="running"?"bg-green-400":t.state==="updating"?"bg-yellow-400":t.state==="starting"?"bg-blue-400":"bg-gray-300"}`})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(a=t.user)==null?void 0:a.username," • ",(l=t.unit)==null?void 0:l.shortName,((n=t.node)==null?void 0:n.region)&&` • ${t.node.region.name}`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.cpuPercent,"%"]})," CPU"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.memoryMiB," MiB"]})," RAM"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:[t.diskMiB," MiB"]})," Disk"]})]}),e.jsx(fe,{className:"w-4 h-4 text-gray-400"})]})]})},t.id)}),S.length===0&&e.jsx("div",{className:"text-center py-6 bg-white rounded-md border border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-500",children:"No servers found"})})]})]}),y==="create"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{x("list"),f(null)},className:"flex items-center text-gray-600 hover:bg-gray-100 p-2 cursor-pointer rounded-md transition hover:text-gray-900",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Create Server"})})]}),oe()]}),y==="edit"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{x("view"),p(null)},className:"flex items-center text-gray-600 hover:bg-gray-100 p-2 cursor-pointer rounded-md transition hover:text-gray-900",children:e.jsx(F,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsxs("h1",{className:"text-lg font-semibold text-gray-900",children:["Edit Server: ",r==null?void 0:r.name]})})]}),ce()]}),y==="view"&&me()]})})]})};export{we as default};
